<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gradus ‚Äî –ó–ü 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root{
  --bg:#0d0f14;--s1:#161920;--s2:#1e2330;--s3:#252b3b;--bd:#2a2f3d;
  --gold:#FFD700;--am:#f5a623;--gr:#2ecc71;--rd:#e74c3c;--bl:#5b9cf6;--pu:#a78bfa;
  --tx:#e8eaf0;--dm:#7a8196;--mt:#4a5168;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--tx);font-family:'Manrope',sans-serif;font-size:14px;min-height:100vh;}
/* HEADER */
.hdr{background:linear-gradient(135deg,#12151e,#0a0c10);border-bottom:1px solid rgba(255,215,0,.15);padding:14px 24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;}
.hbr{display:flex;align-items:center;gap:14px;}
.bname{font-family:'Bebas Neue',sans-serif;font-size:2rem;letter-spacing:6px;color:var(--gold);line-height:1;}
.bsub{color:var(--dm);font-size:10px;margin-top:2px;letter-spacing:1px;}
.hrt{display:flex;flex-direction:column;align-items:flex-end;gap:3px;}
.badge{background:var(--gr);color:#000;padding:4px 12px;border-radius:20px;font-size:10px;font-weight:800;}
#syncSt{font-size:10px;color:var(--mt);}
/* TABS */
.tabs{display:flex;border-bottom:1px solid var(--bd);background:var(--s1);padding:0 24px;overflow-x:auto;}
.tab{padding:12px 16px;font-size:11px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--dm);cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;white-space:nowrap;}
.tab.active{color:var(--gold);border-bottom-color:var(--gold);}
.page{display:none;}.page.active{display:block;}
/* CALC */
.cly{display:grid;grid-template-columns:375px 1fr;min-height:calc(100vh - 106px);}
.lft{background:var(--s1);border-right:1px solid var(--bd);padding:20px 16px;overflow-y:auto;}
.rgt{padding:20px 24px;overflow-y:auto;}
.stl{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--dm);margin-bottom:12px;display:flex;align-items:center;gap:7px;}
.stl::before{content:'';width:5px;height:5px;background:var(--gold);border-radius:50%;flex-shrink:0;}
.afrm{background:var(--s2);border-radius:12px;padding:14px;margin-bottom:14px;border:1px solid var(--bd);}
.fg{display:flex;flex-direction:column;gap:5px;margin-bottom:9px;}
.fg label{font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--dm);}
.fg2{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:9px;}
input,select{background:var(--s3);border:1px solid var(--bd);border-radius:8px;padding:8px 11px;color:var(--tx);font-family:'Manrope',sans-serif;font-size:13px;font-weight:600;outline:none;width:100%;transition:border-color .2s;color-scheme:dark;}
input:focus,select:focus{border-color:var(--gold);}
select option{background:var(--s2);}
.btn-p{width:100%;padding:10px;background:linear-gradient(135deg,var(--gold),var(--am));color:#000;border:none;border-radius:8px;font-family:'Manrope',sans-serif;font-size:13px;font-weight:800;cursor:pointer;}
.btn-p:hover{opacity:.85;}
.bsm{padding:5px 11px;font-size:11px;border-radius:6px;background:transparent;border:1px solid var(--bd);color:var(--dm);cursor:pointer;font-family:'Manrope',sans-serif;font-weight:600;}
.bsm:hover{border-color:var(--rd);color:var(--rd);}
.bgr{color:var(--gr) !important;border-color:rgba(46,204,113,.3) !important;}
.bgr:hover{background:rgba(46,204,113,.08) !important;border-color:var(--gr) !important;}
/* SHIFT CARD */
.sc{background:var(--s2);border-radius:10px;padding:13px;border:1px solid var(--bd);margin-bottom:9px;}
.sc:hover{border-color:rgba(255,215,0,.2);}
.sch{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:7px;}
.scsl{font-size:12px;font-weight:700;}
.scdt{font-size:10px;color:var(--dm);margin-top:2px;}
.scdl{background:none;border:none;color:var(--mt);cursor:pointer;font-size:18px;line-height:1;}
.scdl:hover{color:var(--rd);}
.scmt{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:9px;}
.tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;}
.tz0{background:rgba(91,156,246,.15);color:var(--bl);}
.tz1{background:rgba(255,215,0,.12);color:var(--gold);}
.tz2{background:rgba(46,204,113,.15);color:var(--gr);}
.ttg{background:rgba(167,139,250,.15);color:var(--pu);}
.scss{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:8px;}
.sb{background:rgba(255,255,255,.03);border-radius:6px;padding:7px 9px;}
.sbl{font-size:9px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--mt);margin-bottom:2px;}
.sbv{font-family:'Bebas Neue',sans-serif;font-size:1rem;line-height:1;}
.sb.rv .sbv{color:var(--gold);}.sb.sl .sbv{color:var(--gr);}
.pbw{margin-bottom:8px;}
.pbl{display:flex;justify-content:space-between;font-size:10px;color:var(--mt);margin-bottom:3px;}
.pb{height:5px;background:var(--bd);border-radius:3px;overflow:hidden;}
.pbf{height:100%;border-radius:3px;}
.bnrw{display:flex;flex-wrap:wrap;gap:4px;}
.bchp{display:flex;align-items:center;gap:3px;border:1px solid var(--bd);border-radius:16px;padding:3px 8px;font-size:10px;color:var(--dm);cursor:pointer;background:rgba(255,255,255,.02);user-select:none;}
.bchp.on{background:rgba(46,204,113,.1);border-color:rgba(46,204,113,.3);color:var(--gr);}
.bchp input{display:none;}
.sctot{display:flex;justify-content:space-between;font-size:12px;margin-top:8px;padding-top:8px;border-top:1px solid var(--bd);}
/* KPI */
.kpir{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:18px;}
.kpi{background:var(--s1);border:1px solid var(--bd);border-radius:12px;padding:14px 16px;position:relative;overflow:hidden;}
.kpi::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;}
.kpi.ka::before{background:linear-gradient(90deg,var(--gold),var(--am));}
.kpi.kg::before{background:var(--gr);}
.kpi.kb::before{background:var(--bl);}
.kpi.kr::before{background:var(--rd);}
.kpil{font-size:9px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--dm);margin-bottom:4px;}
.kpiv{font-family:'Bebas Neue',sans-serif;font-size:1.5rem;line-height:1;margin-bottom:1px;}
.kpi.ka .kpiv{color:var(--gold);}.kpi.kg .kpiv{color:var(--gr);}.kpi.kb .kpiv{color:var(--bl);}.kpi.kr .kpiv{color:var(--rd);}
.kpis{font-size:10px;color:var(--mt);}
/* CARD */
.card{background:var(--s1);border:1px solid var(--bd);border-radius:12px;padding:18px;margin-bottom:16px;}
.ctit{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--dm);margin-bottom:13px;display:flex;align-items:center;gap:7px;}
.ctit::before{content:'';width:5px;height:5px;background:var(--gold);border-radius:50%;flex-shrink:0;}
/* TABLE */
table{width:100%;border-collapse:collapse;}
th{font-size:9px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--mt);padding:6px 8px;text-align:right;border-bottom:1px solid var(--bd);white-space:nowrap;}
th:first-child{text-align:left;}
td{padding:8px 8px;text-align:right;border-bottom:1px solid rgba(42,47,61,.4);font-size:11px;font-weight:500;white-space:nowrap;}
td:first-child{text-align:left;color:var(--dm);}
tr:hover td{background:rgba(255,215,0,.02);}
tr.tot td{background:rgba(255,215,0,.06);font-weight:700;border-top:1px solid var(--bd);}
tr.tot td:first-child{color:var(--gold);}
.pos{color:var(--gr);}.neg{color:var(--rd);}.amb{color:var(--gold);}
/* NOTE */
.note{border-radius:10px;padding:12px 15px;font-size:11px;line-height:1.7;margin-bottom:14px;}
.nw{background:rgba(255,215,0,.06);border:1px solid rgba(255,215,0,.15);color:var(--dm);}
.nw strong{color:var(--gold);}
.nok{background:rgba(46,204,113,.07);border:1px solid rgba(46,204,113,.2);color:var(--dm);}
.nok strong{color:var(--gr);}
.ni{background:rgba(91,156,246,.07);border:1px solid rgba(91,156,246,.2);color:var(--dm);}
.ni strong{color:var(--bl);}
.chr{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
/* INNER PAGE */
.ip{padding:22px 26px;max-width:1100px;}
.szg{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:20px;}
.sz{border-radius:12px;padding:18px;border:1px solid var(--bd);}
.sz0{background:rgba(91,156,246,.05);border-color:rgba(91,156,246,.2);}
.sz1{background:rgba(255,215,0,.04);border-color:rgba(255,215,0,.15);}
.sz2{background:rgba(46,204,113,.05);border-color:rgba(46,204,113,.2);}
.szn{font-size:11px;font-weight:800;letter-spacing:2px;text-transform:uppercase;margin-bottom:3px;}
.szm{font-size:11px;color:var(--dm);margin-bottom:3px;}
.szo{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--tx);margin-bottom:12px;}
.tr{display:flex;justify-content:space-between;align-items:center;padding:7px 10px;border-radius:6px;margin-bottom:5px;background:rgba(255,255,255,.03);}
.trl{font-size:11px;color:var(--dm);}
.trr{font-size:13px;font-weight:800;letter-spacing:.5px;}
.t0 .trr{color:var(--mt);}.t1 .trr{color:var(--bl);}.t2 .trr{color:var(--gold);}.t3 .trr{color:var(--gr);}
.t3{background:rgba(46,204,113,.05);}
.sznt{margin-top:10px;font-size:10px;color:var(--mt);line-height:1.6;padding:8px 10px;background:rgba(255,255,255,.02);border-radius:6px;}
.bref{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:10px;}
.bp{background:var(--s2);border:1px solid var(--bd);border-radius:8px;padding:11px 13px;display:flex;justify-content:space-between;align-items:center;}
.bp span{font-size:11px;color:var(--dm);}
.bp strong{font-family:'Bebas Neue',sans-serif;font-size:1rem;color:var(--gr);}
.exg{display:grid;grid-template-columns:repeat(3,1fr);gap:13px;}
.ex{background:var(--s2);border-radius:10px;padding:15px;border:1px solid var(--bd);}
.ext{font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:10px;}
.exr{display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:12px;}
.exr:last-child{border-bottom:none;font-weight:700;font-size:13px;padding-top:8px;}
@media(max-width:900px){
  .cly{grid-template-columns:1fr;}
  .lft{border-right:none;border-bottom:1px solid var(--bd);}
  .kpir,.szg,.chr{grid-template-columns:repeat(2,1fr);}
  .bref,.exg{grid-template-columns:1fr 1fr;}
}
</style>
</head>
<body>

<!-- HEADER -->
<div class="hdr">
  <div class="hbr">
    <div style="width:52px;height:52px;flex-shrink:0;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 946 1039" width="52" height="52" style="display:block">
<style type="text/css">
	.st0{fill:#FFD700;}
	.st1{fill:#FDAE02;}
	.st2{fill:#FF0000;}
	.st3{clip-path:url(#SVGID_2_);fill:#FFD700;}
</style>
<path class="st0" d="M514.5,683.3c7.7,0,13.1,2.4,17.8,7.9c4.5,5.3,6.2,11.2,5.6,19.9c-0.8,11.7-6.6,19.9-16.1,22.7
	c-6.5,1.9-9.9,1.8-16.6-0.5c-7.1-2.4-12.3-7.9-14.4-15.1c-2-6.7-2-10.8,0-18.1C493.8,688.8,501.7,683.3,514.5,683.3z M411.6,683.3
	c16-0.8,28.1,11.5,26,28.4c-1.4,11.5-7.5,19.3-17.2,22.2c-5.8,1.7-9.5,1.7-15.4-0.1c-5.2-1.6-11-6.8-13.5-12.1
	c-2.6-5.5-3-14.9-1-21.9c2.1-7.2,8-13.7,14-15.3C407,683.8,409.3,683.4,411.6,683.3z M255.7,682.4c8.9,0.1,16.3,4.6,21,12.7
	c2.4,4.1,2.7,5.7,2.7,13.2c0,9-1.9,14.5-6.8,19.8c-5.4,6-17.3,8.5-25.6,5.6c-11.6-4.1-17.6-16.8-15-31.6c2-11.2,9-18.2,19.8-19.5
	C253.2,682.5,254.5,682.4,255.7,682.4z M585.7,667.7c-3.2,0-7.3,2.1-8.7,4.7c-0.7,1.3-1,11-0.8,28.7c0.3,26.4,0.3,26.8,2.9,32.2
	c4.1,8.8,11.1,14.6,20.7,17c5,1.3,16.9,0.5,21.3-1.3c1.9-0.8,5.4-2.9,7.8-4.6l4.3-3.1l0.9,2.4c1.3,3.4,5.8,6.7,9.3,6.7
	c5.8-0.1,8.3-5.5,8.8-8.1c0.1-0.5,0-1.5,0-1.5V709c0-33.7-0.1-35.6-2-37.9c-4-5.1-12.7-4.2-15.5,1.7c-1.3,2.8-1.6,7.2-1.5,26.1
	l0.1,22.7l-2.8,4.5c-3.8,6.1-9.7,9.2-17.6,9.2c-7.1,0-11.9-2.1-15-6.4c-2.1-3-2.3-4.2-2.7-29.3c-0.5-25.9-0.2-26.4-2.6-28.9
	c-1.3-1.4-3.4-2.5-5-2.9C587.1,667.8,586.1,667.7,585.7,667.7z M702.3,667.5c-1.6-0.1-3.2,0-4.8,0.1c-15.9,1-27.5,11-27.5,23.5
	c0.1,13.3,9.6,21.1,30.3,24.7c12.3,2.2,16.7,4.9,16.7,10.5c0,7.3-6.1,10.6-18.2,9.9c-8.9-0.5-12.9-2-18.6-6.9
	c-8.9-7.7-17.9,1.8-10.1,10.6c7.9,9,22.5,13.1,38,10.6c11.7-1.9,22.2-9.5,24.7-17.8c1.6-5.4,1.5-13.7-0.2-17
	c-3.7-7.1-9.4-10.2-26.5-14.6c-7-1.8-13.7-3.8-14.8-4.4c-2.6-1.4-4.3-6-3.2-8.9c2.2-6.1,16.6-7.2,26.9-2c6.5,3.3,8,3.4,11.4,0.7
	c2.8-2.2,3.5-6.4,1.6-9.9C725.6,671.8,713.7,667.8,702.3,667.5z M408.1,667.5c-5.1,0.1-10.1,1.2-14.6,3.2
	c-16.1,7.4-25.6,26.1-22.8,44.5c2.8,17.8,14.9,31.8,30.6,35.1c6,1.3,17.3,0.2,22.5-2.1c2.5-1.1,6.4-3.5,8.7-5.4l4.2-3.4l1.2,3.9
	c1.4,4.6,4.3,7,8.7,7c3.2,0,7.4-2.1,8.1-5c0.3-0.9,0.4-2.2,0.4-3.8c0-5.4,0-18.7,0-33.7L455,676c0,0-0.2-1.9-0.7-3.2
	c-0.5-1.3-1.7-2.3-1.7-2.3c-3.6-3.6-9.9-3.3-13.5,0.7c-1.5,1.7-2.1,4.1-2.1,5.2c0,2.7-0.3,2.6-6-1.9
	C425,669.7,416.6,667.3,408.1,667.5z M249.4,667.4c-3,0.1-5.9,0.5-8.5,1.3c-11.3,3.4-18.9,9.9-24.2,20.6c-3.1,6.2-3.7,8.8-3.7,19.3
	c-0.1,8.9,0.7,12.5,3.7,19c4.2,8.9,11,16,19.1,20c5.9,2.9,7.3,3.2,16.1,3.2c10.8,0.1,14.6-1.3,23.1-8.2l4.4-3.6l-0.7,6.4
	c-1.2,11.7-6,18.1-15.9,21.4c-8.6,2.9-22.6,1.3-30.3-3.4c-4.1-2.5-8.9-2.5-11.4,0c-6.2,6.2,2.5,15.1,18.2,18.5
	c7.9,1.7,19.1,1.9,26,0.4c8.2-1.8,12.9-4.2,18.9-9.7c5.8-5.3,10.1-12.7,11.9-20.3c1.2-5.4,1.4-60.7,0.4-76.1
	c-0.1-2.2,0.1-2.1-0.8-3.9c-1.7-3.4-6.4-4.8-9.8-4.1c-3.3,0.6-6.7,4.6-6.7,7.9c0,3.1-0.4,3-5.3-1.2
	C268,669.9,258.3,667.1,249.4,667.4z M353.4,667.1c-4.2,0.1-8.8,1.7-13.5,4.8c-2.8,1.9-5.2,3.4-5.4,3.4s-1-1.3-1.9-2.9
	c-2.1-4-6.4-5.7-11-4.2c-6.4,2.1-6.5,2.8-6.5,40.7c0,35.9,0,36.1,4.8,40c2.5,2.1,7.8,1.5,10.9-1.2c0,0,1.6-1.2,2.2-2.4
	c0.5-1,0.7-2.7,0.7-2.7l0.4-21.2c0.5-22.7,0.6-24,2.8-27.9c1.3-2.2,4.2-5.3,6.4-6.8c3.4-2.2,5.3-2.7,10.7-2.7c8.5,0,11-2,11-8.5
	c0-3.6-0.5-4.7-2.4-6C359.8,667.9,356.7,667,353.4,667.1z M547.4,625.3c-2.4-0.1-4.8,0.5-6.5,1.9c-2.3,1.9-2.4,2.1-2.9,27.1
	l-0.5,25.2l-2.5-2.7c-8.7-9.3-25.9-12-40.5-6.5c-13.7,5.2-23.5,21.3-23.5,38.5c0,20.7,13.4,38.2,31.7,41.5
	c7.5,1.3,16.7,0.3,22.4-2.6c2.7-1.4,6.8-4.1,8.9-6.1l4-3.6v3.2c0,4.5,4.7,9,9.3,9c4.3,0.1,7.3-3.1,8.2-6.4c0.4-1.7,0.4-5.3,0.4-5.3
	l0-51.4v-54.4c0,0-0.1-2.1-0.5-3.1c-0.3-0.8-1.5-2.2-1.5-2.2C552.5,626,549.7,625.4,547.4,625.3z"/>
<path class="st0" d="M579.2,786l-4.4-4.1c-35.1,38.1-72.1,69.1-106.9,88.9l3,5.2l3,5.2c36.2-20.6,74.1-52.4,109.8-91.1L579.2,786z
	 M470.9,876l2.7-5.3c-35.5-18.2-72.4-48.9-107.6-88.6l-4.5,4l-4.5,4c35.8,40.4,73.9,72.3,111.1,91.4L470.9,876z M583.6,790.1
	c2.2-2.4,2.1-6.2-0.3-8.5c-2.4-2.2-6.2-2.1-8.5,0.3l4.4,4.1L583.6,790.1z M366,782c-2.2-2.5-6-2.7-8.5-0.5c-2.5,2.2-2.7,6-0.5,8.5
	l4.5-4L366,782z M470.9,876l-2.7,5.3l2.9,1.5l2.8-1.6L470.9,876z"/>
<path class="st0" d="M743,434h-6c0,68.5-11.8,120.5-46.1,177.4l5.1,3.1l5.1,3.1C736.8,558.5,749,504.3,749,434H743z M253.5,614.5
	l5-3.3C221.3,555.9,209,502.5,209,434h-6h-6c0,70.3,12.7,126.1,51.5,183.8L253.5,614.5z M473,164v6c145.8,0,264,118.2,264,264h6h6
	c0-152.4-123.6-276-276-276V164z M203,434h6c0-145.8,118.2-264,264-264v-6v-6c-152.4,0-276,123.6-276,276H203z M690.9,611.4
	c-1.7,2.8-0.8,6.5,2,8.2c2.8,1.7,6.5,0.8,8.2-2l-5.1-3.1L690.9,611.4z M248.5,617.8c1.8,2.7,5.6,3.5,8.3,1.6
	c2.7-1.8,3.5-5.6,1.6-8.3l-5,3.3L248.5,617.8z"/>
<path class="st0" d="M500,420.5h-6v96h6h6v-96H500z M457.5,420.5h-6v96h6h6v-96H457.5z M415.5,420.5h-6v96h6h6v-96H415.5z
	 M494,516.5c0,3.3,2.7,6,6,6c3.3,0,6-2.7,6-6h-6H494z M506,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H506z M451.5,516.5
	c0,3.3,2.7,6,6,6c3.3,0,6-2.7,6-6h-6H451.5z M463.5,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H463.5z M409.5,516.5c0,3.3,2.7,6,6,6
	c3.3,0,6-2.7,6-6h-6H409.5z M421.5,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H421.5z"/>
<path class="st0" d="M543,368v5h5v-5v-5h-5V368z M538,368.4l0.8,4.9c1.4-0.2,2.8-0.3,4.2-0.3v-5v-5c-2,0-3.9,0.2-5.8,0.5L538,368.4z
	 M538,369.4h5v-1h-5h-5v1H538z M543,369v-5c-2,0-3.9,0.2-5.8,0.5l0.8,4.9l0.8,4.9c1.4-0.2,2.8-0.3,4.2-0.3V369z M548,369v-5h-5v5v5
	h5V369z M578,399h5c0-19.3-15.7-35-35-35v5v5c13.8,0,25,11.2,25,25H578z M578,457h5v-58h-5h-5v58H578z M548,487v5
	c19.3,0,35-15.7,35-35h-5h-5c0,13.8-11.2,25-25,25V487z M543,487v5h5v-5v-5h-5V487z M538,486.6l-0.8,4.9c1.9,0.3,3.8,0.5,5.8,0.5v-5
	v-5c-1.4,0-2.8-0.1-4.2-0.3L538,486.6z M538,487.6h5v-1h-5h-5v1H538z M542.2,488l0.1-5c-1.2,0-2.4-0.1-3.5-0.3l-0.8,4.9l-0.8,4.9
	c1.6,0.3,3.2,0.4,4.9,0.5L542.2,488z M543,488l0.1-5l-0.8,0l-0.1,5l-0.1,5l0.8,0L543,488z M548,488v-5h-5v5v5h5V488z M548.8,488
	l-0.1-5l-0.8,0l0.1,5l0.1,5l0.8,0L548.8,488z M579,457h-5c0,14.1-11.3,25.6-25.3,26l0.1,5l0.1,5c19.5-0.5,35.1-16.4,35.1-36H579z
	 M579,399h-5v58h5h5v-58H579z M548,368v5c14.4,0,26,11.6,26,26h5h5c0-19.9-16.1-36-36-36V368z M543,368v-5V368z M538,368.4l-0.8-4.9
	l-4.2,0.7v4.3H538z M538,369.4h-5v5.9l5.8-1L538,369.4z M543,369v-5V369z M548,487v5V487z M538,486.6l0.8-4.9l-5.8-1v5.9H538z
	 M538,487.6h-5v4.3l4.2,0.7L538,487.6z M542.2,488l-0.1,5l0,0l0,0L542.2,488z M543,488l-0.1,5l0,0h0V488z M548,488v5h0l0,0L548,488z
	 M548.8,488l0.1,5l0,0l0,0L548.8,488z"/>
<polygon class="st0" points="378,389 378,395 475,395 475,389 475,383 378,383 "/>
<polygon class="st1" points="443,338 443,344 481,344 481,338 481,332 443,332 "/>
<polygon class="st2" points="501,338 501,344 525,344 525,338 525,332 501,332 "/>
<polygon class="st0" points="503,389 503,395 538,395 538,389 538,383 503,383 "/>
<path class="st0" d="M453.5,305.5l-4.1,4.4c7.8,7.4,18.6,12.6,28.1,16.5c4.8,1.9,9.5,3.6,13.5,5c4.1,1.5,7.3,2.6,9.5,3.6l2.5-5.5
	l2.5-5.5c-2.8-1.2-6.5-2.6-10.4-4c-4-1.4-8.5-3-13-4.9c-9.2-3.7-18.2-8.3-24.4-14.1L453.5,305.5z M424.5,293l-0.2,6
	c2.9,0.1,5.7-0.1,9.6,1.1c3.9,1.2,9.1,3.7,15.5,9.8l4.1-4.4l4.1-4.4c-7.6-7.2-14.4-10.8-20.3-12.5c-5.8-1.7-10.5-1.5-12.6-1.6
	L424.5,293z M389,333.5l6,0.3c0.3-7.3,2-16.5,6.4-23.6c4.2-6.7,10.9-11.7,22.8-11.2l0.3-6l0.3-6c-16.5-0.7-27.2,6.8-33.5,16.8
	c-6,9.6-7.9,21.2-8.3,29.4L389,333.5z M500.5,335c3,1.4,6.6,0,7.9-3s0-6.6-3-7.9l-2.5,5.5L500.5,335z M453.5,305.5l-4.1,4.4
	L453.5,305.5z M424.5,293l-0.3,6l0,0l0,0L424.5,293z M383,333.2c-0.1,3.3,2.4,6.1,5.7,6.3s6.1-2.4,6.3-5.7l-6-0.3L383,333.2z"/>
<g>
	<defs>
		<path id="SVGID_1_" d="M469,337c0-8.3,6.7-15,15-15h14c8.3,0,15,6.7,15,15v60c0,9.9-8.1,18-18,18h-8c-9.9,0-18-8.1-18-18V337z"/>
	</defs>
	<clipPath id="SVGID_2_">
		<use xlink:href="#SVGID_1_"  style="overflow:visible;"/>
	</clipPath>
	<path class="st3" d="M484,322v-12c-14.9,0-27,12.1-27,27h12h12c0-1.7,1.3-3,3-3V322z M498,322v12c1.7,0,3,1.3,3,3h12h12
		c0-14.9-12.1-27-27-27V322z M513,397h-12c0,3.3-2.7,6-6,6v12v12c16.6,0,30-13.4,30-30H513z M487,415v-12c-3.3,0-6-2.7-6-6h-12h-12
		c0,16.6,13.4,30,30,30V415z M469,397h12v-60h-12h-12v60H469z M495,415v-12h-8v12v12h8V415z M513,337h-12v60h12h12v-60H513z
		 M484,322v12h14v-12v-12h-14V322z"/>
</g>
<path class="st0" d="M529.5,332c4.8,0.2,8.5,4.2,8.5,9v186l0,0.5c-0.2,9.6-8,17.3-17.5,17.5l-0.5,0H398c-11.4,0-20.7-9.1-21-20.5
	l0-0.5V341c0-4.8,3.8-8.7,8.5-9l0.5,0h83v12h-80v180c0,5,4,9,9,9h122c3.3,0,6-2.7,6-6V344h-13v-12h16L529.5,332z"/>
<path class="st0" d="M470,223.6c-108,0-195.5,87.5-195.5,195.5S362,614.6,470,614.6s195.5-87.5,195.5-195.5S577.9,223.6,470,223.6z
	 M470,604.4c-102.3,0-185.3-82.9-185.3-185.3S367.6,233.9,470,233.9s185.3,82.9,185.3,185.3S572.3,604.4,470,604.4z"/>
</svg></div>
    <div>
      <div class="bname">gradus</div>
      <div class="bsub">–°–∏—Å—Ç–µ–º–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ ¬∑ 2026</div>
    </div>
  </div>
  <div class="hrt">
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="text-align:right;">
        <div style="font-size:11px;color:var(--dm);">–°–µ—Ä–∏–∫ –°–º–∞–≥—É–ª–æ–≤ ¬∑ –ï—Ä–±–æ–ª –°–∞–¥—ã–∫–æ–≤</div>
        <div style="font-size:10px;color:var(--mt);margin-top:1px;">–£—Ä–¥–∂–∞—Ä ¬∑ –ê–ª–∫–æ–º–∞—Ä–∫–µ—Ç</div>
      </div>
      <span class="badge">‚úì –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</span>
    </div>
    <span id="syncSt">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</span>
  </div>
</div>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="ST('calc',this)">üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
  <div class="tab" onclick="ST('scheme',this)">üìã –°—Ö–µ–º–∞ –ó–ü</div>
  <div class="tab" onclick="ST('forecast',this)">üìà –ü—Ä–æ–≥–Ω–æ–∑ 2026</div>
  <div class="tab" onclick="ST('settings',this)">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
</div>

<!-- ====== CALC ====== -->
<div class="page active" id="tab-calc">
<div class="cly">
  <div class="lft">
    <div class="stl">–î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É</div>
    <div class="afrm">
      <div class="fg2">
        <div class="fg" style="margin-bottom:0;"><label>–ù–∞—á–∞–ª–æ</label><input type="date" id="fS" value="2026-01-05"></div>
        <div class="fg" style="margin-bottom:0;"><label>–ö–æ–Ω–µ—Ü</label><input type="date" id="fE" value="2026-01-19"></div>
      </div>
      <div class="fg2" style="margin-top:9px;">
        <div class="fg" style="margin-bottom:0;"><label>–ü—Ä–æ–¥–∞–≤–µ—Ü</label>
          <select id="fSl"><option>–°–µ—Ä–∏–∫ –°–º–∞–≥—É–ª–æ–≤</option><option>–ï—Ä–±–æ–ª –°–∞–¥—ã–∫–æ–≤</option></select>
        </div>
        <div class="fg" style="margin-bottom:0;"><label>–í—ã—Ä—É—á–∫–∞ (‚Ç∏)</label>
          <input type="number" id="fRv" placeholder="7500000" step="50000">
        </div>
      </div>
      <div style="margin-top:10px;"><button class="btn-p" onclick="addShift()">+ –î–æ–±–∞–≤–∏—Ç—å —Å–º–µ–Ω—É</button></div>
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
      <div class="stl" style="margin-bottom:0;">–°–º–µ–Ω—ã <span id="shCnt" style="color:var(--gold);margin-left:4px;">0</span></div>
      <div style="display:flex;gap:6px;">
        <button class="bsm bgr" onclick="expXL()">üì• Excel</button>
        <button class="bsm" onclick="clearAll()">–û—á–∏—Å—Ç–∏—Ç—å</button>
      </div>
    </div>
    <div id="shList"><div style="text-align:center;padding:32px 14px;color:var(--mt);"><div style="font-size:2rem;margin-bottom:8px;">üìã</div><div style="font-size:12px;line-height:1.6;">–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é —Å–º–µ–Ω—É<br>—á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤—ã—à–µ</div></div></div>
  </div>
  <div class="rgt">
    <div id="empR" style="display:flex;align-items:center;justify-content:center;height:75vh;flex-direction:column;gap:12px;color:var(--mt);text-align:center;">
      <div style="opacity:.1;width:80px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 946 1039" width="80" height="80" style="display:block;opacity:.1">
<style type="text/css">
	.st0{fill:#FFD700;}
	.st1{fill:#FDAE02;}
	.st2{fill:#FF0000;}
	.st3{clip-path:url(#SVGID_2_);fill:#FFD700;}
</style>
<path class="st0" d="M514.5,683.3c7.7,0,13.1,2.4,17.8,7.9c4.5,5.3,6.2,11.2,5.6,19.9c-0.8,11.7-6.6,19.9-16.1,22.7
	c-6.5,1.9-9.9,1.8-16.6-0.5c-7.1-2.4-12.3-7.9-14.4-15.1c-2-6.7-2-10.8,0-18.1C493.8,688.8,501.7,683.3,514.5,683.3z M411.6,683.3
	c16-0.8,28.1,11.5,26,28.4c-1.4,11.5-7.5,19.3-17.2,22.2c-5.8,1.7-9.5,1.7-15.4-0.1c-5.2-1.6-11-6.8-13.5-12.1
	c-2.6-5.5-3-14.9-1-21.9c2.1-7.2,8-13.7,14-15.3C407,683.8,409.3,683.4,411.6,683.3z M255.7,682.4c8.9,0.1,16.3,4.6,21,12.7
	c2.4,4.1,2.7,5.7,2.7,13.2c0,9-1.9,14.5-6.8,19.8c-5.4,6-17.3,8.5-25.6,5.6c-11.6-4.1-17.6-16.8-15-31.6c2-11.2,9-18.2,19.8-19.5
	C253.2,682.5,254.5,682.4,255.7,682.4z M585.7,667.7c-3.2,0-7.3,2.1-8.7,4.7c-0.7,1.3-1,11-0.8,28.7c0.3,26.4,0.3,26.8,2.9,32.2
	c4.1,8.8,11.1,14.6,20.7,17c5,1.3,16.9,0.5,21.3-1.3c1.9-0.8,5.4-2.9,7.8-4.6l4.3-3.1l0.9,2.4c1.3,3.4,5.8,6.7,9.3,6.7
	c5.8-0.1,8.3-5.5,8.8-8.1c0.1-0.5,0-1.5,0-1.5V709c0-33.7-0.1-35.6-2-37.9c-4-5.1-12.7-4.2-15.5,1.7c-1.3,2.8-1.6,7.2-1.5,26.1
	l0.1,22.7l-2.8,4.5c-3.8,6.1-9.7,9.2-17.6,9.2c-7.1,0-11.9-2.1-15-6.4c-2.1-3-2.3-4.2-2.7-29.3c-0.5-25.9-0.2-26.4-2.6-28.9
	c-1.3-1.4-3.4-2.5-5-2.9C587.1,667.8,586.1,667.7,585.7,667.7z M702.3,667.5c-1.6-0.1-3.2,0-4.8,0.1c-15.9,1-27.5,11-27.5,23.5
	c0.1,13.3,9.6,21.1,30.3,24.7c12.3,2.2,16.7,4.9,16.7,10.5c0,7.3-6.1,10.6-18.2,9.9c-8.9-0.5-12.9-2-18.6-6.9
	c-8.9-7.7-17.9,1.8-10.1,10.6c7.9,9,22.5,13.1,38,10.6c11.7-1.9,22.2-9.5,24.7-17.8c1.6-5.4,1.5-13.7-0.2-17
	c-3.7-7.1-9.4-10.2-26.5-14.6c-7-1.8-13.7-3.8-14.8-4.4c-2.6-1.4-4.3-6-3.2-8.9c2.2-6.1,16.6-7.2,26.9-2c6.5,3.3,8,3.4,11.4,0.7
	c2.8-2.2,3.5-6.4,1.6-9.9C725.6,671.8,713.7,667.8,702.3,667.5z M408.1,667.5c-5.1,0.1-10.1,1.2-14.6,3.2
	c-16.1,7.4-25.6,26.1-22.8,44.5c2.8,17.8,14.9,31.8,30.6,35.1c6,1.3,17.3,0.2,22.5-2.1c2.5-1.1,6.4-3.5,8.7-5.4l4.2-3.4l1.2,3.9
	c1.4,4.6,4.3,7,8.7,7c3.2,0,7.4-2.1,8.1-5c0.3-0.9,0.4-2.2,0.4-3.8c0-5.4,0-18.7,0-33.7L455,676c0,0-0.2-1.9-0.7-3.2
	c-0.5-1.3-1.7-2.3-1.7-2.3c-3.6-3.6-9.9-3.3-13.5,0.7c-1.5,1.7-2.1,4.1-2.1,5.2c0,2.7-0.3,2.6-6-1.9
	C425,669.7,416.6,667.3,408.1,667.5z M249.4,667.4c-3,0.1-5.9,0.5-8.5,1.3c-11.3,3.4-18.9,9.9-24.2,20.6c-3.1,6.2-3.7,8.8-3.7,19.3
	c-0.1,8.9,0.7,12.5,3.7,19c4.2,8.9,11,16,19.1,20c5.9,2.9,7.3,3.2,16.1,3.2c10.8,0.1,14.6-1.3,23.1-8.2l4.4-3.6l-0.7,6.4
	c-1.2,11.7-6,18.1-15.9,21.4c-8.6,2.9-22.6,1.3-30.3-3.4c-4.1-2.5-8.9-2.5-11.4,0c-6.2,6.2,2.5,15.1,18.2,18.5
	c7.9,1.7,19.1,1.9,26,0.4c8.2-1.8,12.9-4.2,18.9-9.7c5.8-5.3,10.1-12.7,11.9-20.3c1.2-5.4,1.4-60.7,0.4-76.1
	c-0.1-2.2,0.1-2.1-0.8-3.9c-1.7-3.4-6.4-4.8-9.8-4.1c-3.3,0.6-6.7,4.6-6.7,7.9c0,3.1-0.4,3-5.3-1.2
	C268,669.9,258.3,667.1,249.4,667.4z M353.4,667.1c-4.2,0.1-8.8,1.7-13.5,4.8c-2.8,1.9-5.2,3.4-5.4,3.4s-1-1.3-1.9-2.9
	c-2.1-4-6.4-5.7-11-4.2c-6.4,2.1-6.5,2.8-6.5,40.7c0,35.9,0,36.1,4.8,40c2.5,2.1,7.8,1.5,10.9-1.2c0,0,1.6-1.2,2.2-2.4
	c0.5-1,0.7-2.7,0.7-2.7l0.4-21.2c0.5-22.7,0.6-24,2.8-27.9c1.3-2.2,4.2-5.3,6.4-6.8c3.4-2.2,5.3-2.7,10.7-2.7c8.5,0,11-2,11-8.5
	c0-3.6-0.5-4.7-2.4-6C359.8,667.9,356.7,667,353.4,667.1z M547.4,625.3c-2.4-0.1-4.8,0.5-6.5,1.9c-2.3,1.9-2.4,2.1-2.9,27.1
	l-0.5,25.2l-2.5-2.7c-8.7-9.3-25.9-12-40.5-6.5c-13.7,5.2-23.5,21.3-23.5,38.5c0,20.7,13.4,38.2,31.7,41.5
	c7.5,1.3,16.7,0.3,22.4-2.6c2.7-1.4,6.8-4.1,8.9-6.1l4-3.6v3.2c0,4.5,4.7,9,9.3,9c4.3,0.1,7.3-3.1,8.2-6.4c0.4-1.7,0.4-5.3,0.4-5.3
	l0-51.4v-54.4c0,0-0.1-2.1-0.5-3.1c-0.3-0.8-1.5-2.2-1.5-2.2C552.5,626,549.7,625.4,547.4,625.3z"/>
<path class="st0" d="M579.2,786l-4.4-4.1c-35.1,38.1-72.1,69.1-106.9,88.9l3,5.2l3,5.2c36.2-20.6,74.1-52.4,109.8-91.1L579.2,786z
	 M470.9,876l2.7-5.3c-35.5-18.2-72.4-48.9-107.6-88.6l-4.5,4l-4.5,4c35.8,40.4,73.9,72.3,111.1,91.4L470.9,876z M583.6,790.1
	c2.2-2.4,2.1-6.2-0.3-8.5c-2.4-2.2-6.2-2.1-8.5,0.3l4.4,4.1L583.6,790.1z M366,782c-2.2-2.5-6-2.7-8.5-0.5c-2.5,2.2-2.7,6-0.5,8.5
	l4.5-4L366,782z M470.9,876l-2.7,5.3l2.9,1.5l2.8-1.6L470.9,876z"/>
<path class="st0" d="M743,434h-6c0,68.5-11.8,120.5-46.1,177.4l5.1,3.1l5.1,3.1C736.8,558.5,749,504.3,749,434H743z M253.5,614.5
	l5-3.3C221.3,555.9,209,502.5,209,434h-6h-6c0,70.3,12.7,126.1,51.5,183.8L253.5,614.5z M473,164v6c145.8,0,264,118.2,264,264h6h6
	c0-152.4-123.6-276-276-276V164z M203,434h6c0-145.8,118.2-264,264-264v-6v-6c-152.4,0-276,123.6-276,276H203z M690.9,611.4
	c-1.7,2.8-0.8,6.5,2,8.2c2.8,1.7,6.5,0.8,8.2-2l-5.1-3.1L690.9,611.4z M248.5,617.8c1.8,2.7,5.6,3.5,8.3,1.6
	c2.7-1.8,3.5-5.6,1.6-8.3l-5,3.3L248.5,617.8z"/>
<path class="st0" d="M500,420.5h-6v96h6h6v-96H500z M457.5,420.5h-6v96h6h6v-96H457.5z M415.5,420.5h-6v96h6h6v-96H415.5z
	 M494,516.5c0,3.3,2.7,6,6,6c3.3,0,6-2.7,6-6h-6H494z M506,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H506z M451.5,516.5
	c0,3.3,2.7,6,6,6c3.3,0,6-2.7,6-6h-6H451.5z M463.5,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H463.5z M409.5,516.5c0,3.3,2.7,6,6,6
	c3.3,0,6-2.7,6-6h-6H409.5z M421.5,420.5c0-3.3-2.7-6-6-6c-3.3,0-6,2.7-6,6h6H421.5z"/>
<path class="st0" d="M543,368v5h5v-5v-5h-5V368z M538,368.4l0.8,4.9c1.4-0.2,2.8-0.3,4.2-0.3v-5v-5c-2,0-3.9,0.2-5.8,0.5L538,368.4z
	 M538,369.4h5v-1h-5h-5v1H538z M543,369v-5c-2,0-3.9,0.2-5.8,0.5l0.8,4.9l0.8,4.9c1.4-0.2,2.8-0.3,4.2-0.3V369z M548,369v-5h-5v5v5
	h5V369z M578,399h5c0-19.3-15.7-35-35-35v5v5c13.8,0,25,11.2,25,25H578z M578,457h5v-58h-5h-5v58H578z M548,487v5
	c19.3,0,35-15.7,35-35h-5h-5c0,13.8-11.2,25-25,25V487z M543,487v5h5v-5v-5h-5V487z M538,486.6l-0.8,4.9c1.9,0.3,3.8,0.5,5.8,0.5v-5
	v-5c-1.4,0-2.8-0.1-4.2-0.3L538,486.6z M538,487.6h5v-1h-5h-5v1H538z M542.2,488l0.1-5c-1.2,0-2.4-0.1-3.5-0.3l-0.8,4.9l-0.8,4.9
	c1.6,0.3,3.2,0.4,4.9,0.5L542.2,488z M543,488l0.1-5l-0.8,0l-0.1,5l-0.1,5l0.8,0L543,488z M548,488v-5h-5v5v5h5V488z M548.8,488
	l-0.1-5l-0.8,0l0.1,5l0.1,5l0.8,0L548.8,488z M579,457h-5c0,14.1-11.3,25.6-25.3,26l0.1,5l0.1,5c19.5-0.5,35.1-16.4,35.1-36H579z
	 M579,399h-5v58h5h5v-58H579z M548,368v5c14.4,0,26,11.6,26,26h5h5c0-19.9-16.1-36-36-36V368z M543,368v-5V368z M538,368.4l-0.8-4.9
	l-4.2,0.7v4.3H538z M538,369.4h-5v5.9l5.8-1L538,369.4z M543,369v-5V369z M548,487v5V487z M538,486.6l0.8-4.9l-5.8-1v5.9H538z
	 M538,487.6h-5v4.3l4.2,0.7L538,487.6z M542.2,488l-0.1,5l0,0l0,0L542.2,488z M543,488l-0.1,5l0,0h0V488z M548,488v5h0l0,0L548,488z
	 M548.8,488l0.1,5l0,0l0,0L548.8,488z"/>
<polygon class="st0" points="378,389 378,395 475,395 475,389 475,383 378,383 "/>
<polygon class="st1" points="443,338 443,344 481,344 481,338 481,332 443,332 "/>
<polygon class="st2" points="501,338 501,344 525,344 525,338 525,332 501,332 "/>
<polygon class="st0" points="503,389 503,395 538,395 538,389 538,383 503,383 "/>
<path class="st0" d="M453.5,305.5l-4.1,4.4c7.8,7.4,18.6,12.6,28.1,16.5c4.8,1.9,9.5,3.6,13.5,5c4.1,1.5,7.3,2.6,9.5,3.6l2.5-5.5
	l2.5-5.5c-2.8-1.2-6.5-2.6-10.4-4c-4-1.4-8.5-3-13-4.9c-9.2-3.7-18.2-8.3-24.4-14.1L453.5,305.5z M424.5,293l-0.2,6
	c2.9,0.1,5.7-0.1,9.6,1.1c3.9,1.2,9.1,3.7,15.5,9.8l4.1-4.4l4.1-4.4c-7.6-7.2-14.4-10.8-20.3-12.5c-5.8-1.7-10.5-1.5-12.6-1.6
	L424.5,293z M389,333.5l6,0.3c0.3-7.3,2-16.5,6.4-23.6c4.2-6.7,10.9-11.7,22.8-11.2l0.3-6l0.3-6c-16.5-0.7-27.2,6.8-33.5,16.8
	c-6,9.6-7.9,21.2-8.3,29.4L389,333.5z M500.5,335c3,1.4,6.6,0,7.9-3s0-6.6-3-7.9l-2.5,5.5L500.5,335z M453.5,305.5l-4.1,4.4
	L453.5,305.5z M424.5,293l-0.3,6l0,0l0,0L424.5,293z M383,333.2c-0.1,3.3,2.4,6.1,5.7,6.3s6.1-2.4,6.3-5.7l-6-0.3L383,333.2z"/>
<g>
	<defs>
		<path id="SVGID_1_" d="M469,337c0-8.3,6.7-15,15-15h14c8.3,0,15,6.7,15,15v60c0,9.9-8.1,18-18,18h-8c-9.9,0-18-8.1-18-18V337z"/>
	</defs>
	<clipPath id="SVGID_2_">
		<use xlink:href="#SVGID_1_"  style="overflow:visible;"/>
	</clipPath>
	<path class="st3" d="M484,322v-12c-14.9,0-27,12.1-27,27h12h12c0-1.7,1.3-3,3-3V322z M498,322v12c1.7,0,3,1.3,3,3h12h12
		c0-14.9-12.1-27-27-27V322z M513,397h-12c0,3.3-2.7,6-6,6v12v12c16.6,0,30-13.4,30-30H513z M487,415v-12c-3.3,0-6-2.7-6-6h-12h-12
		c0,16.6,13.4,30,30,30V415z M469,397h12v-60h-12h-12v60H469z M495,415v-12h-8v12v12h8V415z M513,337h-12v60h12h12v-60H513z
		 M484,322v12h14v-12v-12h-14V322z"/>
</g>
<path class="st0" d="M529.5,332c4.8,0.2,8.5,4.2,8.5,9v186l0,0.5c-0.2,9.6-8,17.3-17.5,17.5l-0.5,0H398c-11.4,0-20.7-9.1-21-20.5
	l0-0.5V341c0-4.8,3.8-8.7,8.5-9l0.5,0h83v12h-80v180c0,5,4,9,9,9h122c3.3,0,6-2.7,6-6V344h-13v-12h16L529.5,332z"/>
<path class="st0" d="M470,223.6c-108,0-195.5,87.5-195.5,195.5S362,614.6,470,614.6s195.5-87.5,195.5-195.5S577.9,223.6,470,223.6z
	 M470,604.4c-102.3,0-185.3-82.9-185.3-185.3S367.6,233.9,470,233.9s185.3,82.9,185.3,185.3S572.3,604.4,470,604.4z"/>
</svg></div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:1.8rem;letter-spacing:4px;color:var(--s3);">gradus</div>
      <div style="font-size:12px;line-height:1.7;max-width:260px;">–î–æ–±–∞–≤—å —Å–º–µ–Ω—ã —Å–ª–µ–≤–∞</div>
    </div>
    <div id="anl" style="display:none;">
      <div class="kpir">
        <div class="kpi ka"><div class="kpil">–í—ã—Ä—É—á–∫–∞</div><div class="kpiv" id="kR">‚Äî</div><div class="kpis" id="kRS"></div></div>
        <div class="kpi kg"><div class="kpil">–§–û–¢</div><div class="kpiv" id="kF">‚Äî</div><div class="kpis">—Å –±–æ–Ω—É—Å–∞–º–∏</div></div>
        <div class="kpi kb"><div class="kpil">–§–û–¢ %</div><div class="kpiv" id="kFP">‚Äî</div><div class="kpis">–æ—Ç –≤—ã—Ä—É—á–∫–∏</div></div>
        <div class="kpi kr"><div class="kpil">–°–º–µ–Ω</div><div class="kpiv" id="kSC">‚Äî</div><div class="kpis" id="kSS"></div></div>
      </div>
      <div class="card" style="overflow-x:auto;">
        <div class="ctit">–ò—Ç–æ–≥ –ø–æ —Å–º–µ–Ω–∞–º</div>
        <table><thead><tr>
          <th>#</th><th>–ü—Ä–æ–¥–∞–≤–µ—Ü</th><th>–ü–µ—Ä–∏–æ–¥</th><th>–î–Ω.</th><th>–ó–æ–Ω–∞</th>
          <th>–í—ã—Ä—É—á–∫–∞</th><th>–£—Ä–æ–≤–µ–Ω—å</th><th>%</th>
          <th>–û–∫–ª–∞–¥</th><th>–°—É–º–º–∞%</th><th>–ë–æ–Ω—É—Å—ã</th><th>–ò—Ç–æ–≥–æ</th><th>–§–û–¢%</th><th>–ü–ª–∞–Ω</th>
        </tr></thead><tbody id="tBd"></tbody></table>
      </div>
      <div id="noteEl" class="note nw"></div>
      <div class="chr">
        <div class="card"><div class="ctit">–í—ã—Ä—É—á–∫–∞ vs –ó–ü</div><canvas id="c1" height="190"></canvas></div>
        <div class="card"><div class="ctit">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ó–ü</div><canvas id="c2" height="190"></canvas></div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- ====== SCHEME ====== -->
<div class="page" id="tab-scheme">
<div class="ip">
  <div class="szg" id="schG"></div>
  <div class="card">
    <div class="ctit">–ë–æ–Ω—É—Å—ã –∑–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É ‚Äî –∑–∞ –∫–∞–∂–¥—É—é —Å–º–µ–Ω—É</div>
    <div class="bref" id="bonR"></div>
    <div class="note ni" style="margin-bottom:0;"><strong>–ì–µ–Ω. —É–±–æ—Ä–∫–∞:</strong> 1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü ‚Äî 20 000 ‚Ç∏. –ò—Ç–æ–≥–æ 240 000 ‚Ç∏/–≥–æ–¥ ‚úì</div>
  </div>
  <div class="card"><div class="ctit">–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á—ë—Ç–∞</div><div class="exg" id="exG"></div></div>
</div>
</div>

<!-- ====== FORECAST ====== -->
<div class="page" id="tab-forecast">
<div class="ip" style="max-width:1300px;">
  <div class="note nw">–ü—Ä–æ–≥–Ω–æ–∑ 2026 = —Ñ–∞–∫—Ç 2025 √ó 1.22. –°–º–µ–Ω–∞ = –º–µ—Å—è—Ü √∑ 2. –ë–æ–Ω—É—Å—ã ‚Äî –º–∞–∫—Å–∏–º—É–º. –§–û–¢ = –æ–±–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞.</div>
  <div class="card" style="overflow-x:auto;">
    <div class="ctit">–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ –º–µ—Å—è—Ü–∞–º 2026</div>
    <table><thead><tr>
      <th>–ú–µ—Å—è—Ü</th><th>–ó–æ–Ω–∞</th><th>–§–∞–∫—Ç 2025</th><th>–ü—Ä–æ–≥–Ω–æ–∑ 2026</th>
      <th>–°–º–µ–Ω–∞</th><th>–£—Ä–æ–≤–µ–Ω—å</th><th>%</th><th>–ó–ü</th><th>–ó–ü+–±–æ–Ω</th><th>–§–û–¢√ó2</th><th>–§–û–¢%</th>
    </tr></thead><tbody id="fcBd"></tbody></table>
  </div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
    <div class="card"><div class="ctit">–ó–ü 2025 vs 2026</div><canvas id="fcC1" height="200"></canvas></div>
    <div class="card"><div class="ctit">–§–û–¢ % –æ—Ç –≤—ã—Ä—É—á–∫–∏</div><canvas id="fcC2" height="200"></canvas></div>
  </div>
</div>
</div>

<!-- ====== SETTINGS ====== -->
<div class="page" id="tab-settings">
<div class="ip" style="max-width:960px;">
  <div class="note nw" style="margin-bottom:20px;">–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è <strong>"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"</strong>.</div>

  <div class="card">
    <div class="ctit">–û–∫–ª–∞–¥ –∏ –±–æ–Ω—É—Å—ã</div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px;">
      <div>
        <label style="font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--dm);display:block;margin-bottom:5px;">–û–∫–ª–∞–¥ –∑–∞ —Å–º–µ–Ω—É (‚Ç∏)</label>
        <input type="number" id="sOk" step="1000" min="0">
        <div style="font-size:10px;color:var(--mt);margin-top:3px;">–¢–µ–∫—É—â–∏–π: <span id="sOkCur" style="color:var(--gold);font-weight:700;"></span></div>
      </div>
      <div>
        <label style="font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--dm);display:block;margin-bottom:5px;">–ë–∞–∑–æ–≤—ã–π % (–¥–æ –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä–æ–≥–∞)</label>
        <input type="number" id="sBR" step="0.1" min="0" max="10">
        <div style="font-size:10px;color:var(--mt);margin-top:3px;">–î–ª—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö —Å–µ–∑–æ–Ω–æ–≤</div>
      </div>
    </div>
    <label style="font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--dm);display:block;margin-bottom:8px;">–ë–æ–Ω—É—Å—ã –∑–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É</label>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;" id="sBons"></div>
  </div>

  <div class="card">
    <div class="ctit">–ú–µ—Å—è—Ü–∞ –ø–æ —Å–µ–∑–æ–Ω–∞–º</div>
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;" id="sMons"></div>
  </div>

  <div class="card">
    <div class="ctit">–ü–æ—Ä–æ–≥–∏ –∏ —Å—Ç–∞–≤–∫–∏</div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;" id="sPlans"></div>
  </div>

  <div style="display:flex;gap:10px;margin-top:4px;">
    <button id="savBtn" onclick="saveSettings()" style="flex:1;padding:12px;background:linear-gradient(135deg,var(--gold),var(--am));color:#000;border:none;border-radius:8px;font-family:'Manrope',sans-serif;font-size:14px;font-weight:800;cursor:pointer;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button onclick="resetSettings()" style="padding:12px 20px;background:transparent;border:1px solid var(--bd);color:var(--dm);border-radius:8px;font-family:'Manrope',sans-serif;font-size:13px;font-weight:600;cursor:pointer;">‚Ü©Ô∏è –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
  </div>
</div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ –ö–û–ù–§–ò–ì ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const DEF = {
  oklad: 100000,
  bons: [
    {lbl:'‚è∞ –ë–µ–∑ –æ–ø–æ–∑–¥–∞–Ω–∏–π', amt:10000},
    {lbl:'üìã –û—Ç—á—ë—Ç—ã –≤–æ–≤—Ä–µ–º—è', amt:10000},
    {lbl:'üí∞ –ë–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—á–∏',  amt:10000},
    {lbl:'üßπ –ü–æ—Ä—è–¥–æ–∫',       amt:10000}
  ],
  zbm: [0,0,0,1,2,2,2,2,2,1,1,1],
  zones: [
    {nm:'‚ùÑÔ∏è –ù–∏–∑–∫–∏–π',  ms:'–Ø–Ω–≤¬∑–§–µ–≤¬∑–ú–∞—Ä',         brk:[6500000,7500000,8500000],  rt:[0.015,0.018,0.020,0.022]},
    {nm:'üìä –°—Ä–µ–¥–Ω–∏–π', ms:'–ê–ø—Ä¬∑–û–∫—Ç¬∑–ù–æ—è¬∑–î–µ–∫',      brk:[7500000,8500000,9500000],  rt:[0.015,0.018,0.020,0.022]},
    {nm:'üî• –í—ã—Å–æ–∫–∏–π', ms:'–ú–∞–π¬∑–ò—é–Ω¬∑–ò—é–ª¬∑–ê–≤–≥¬∑–°–µ–Ω',  brk:[9500000,11000000,13000000],rt:[0.015,0.018,0.020,0.022]}
  ]
};
let C = JSON.parse(JSON.stringify(DEF));

function loadCfg(){
  try{ const r=localStorage.getItem('gds_cfg'); if(r) C=JSON.parse(r); }catch(e){}
}
function saveCfg(){
  try{ localStorage.setItem('gds_cfg', JSON.stringify(C)); }catch(e){}
}

// ‚îÄ‚îÄ‚îÄ –†–ê–°–ß–Å–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const TLBL = ['–ë–∞–∑–∞','–°—Ç–∞–Ω–¥–∞—Ä—Ç','–¢–æ–ø','–†–µ–∫–æ—Ä–¥'];
const TCOL = ['var(--mt)','var(--bl)','var(--gold)','var(--gr)'];
const ZCLS = ['tz0','tz1','tz2'];
const MNM  = ['–Ø–Ω–≤–∞—Ä—å','–§–µ–≤—Ä–∞–ª—å','–ú–∞—Ä—Ç','–ê–ø—Ä–µ–ª—å','–ú–∞–π','–ò—é–Ω—å','–ò—é–ª—å','–ê–≤–≥—É—Å—Ç','–°–µ–Ω—Ç—è–±—Ä—å','–û–∫—Ç—è–±—Ä—å','–ù–æ—è–±—Ä—å','–î–µ–∫–∞–±—Ä—å'];
const MSH  = ['–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä','–ê–ø—Ä','–ú–∞–π','–ò—é–Ω','–ò—é–ª','–ê–≤–≥','–°–µ–Ω','–û–∫—Ç','–ù–æ—è','–î–µ–∫'];
const REV25= [11169773.7,8760695.91,6903666.58,12488802.07,16412082.45,18684315.7,24379271,19835447.5,13161530.55,13085823.3,12612485.4,13012231.1];

function gz(ds){ return C.zbm[new Date(ds).getMonth()]; }
function cw(z,r){
  const zn=C.zones[z]; let i=0;
  for(;i<3;i++) if(r<zn.brk[i]) break;
  return {oklad:C.oklad, pct:Math.round(r*zn.rt[i]), rate:zn.rt[i], idx:i, lbl:TLBL[i]};
}
function bTotal(bon){ return bon.reduce((s,v,i)=>s+(v?C.bons[i].amt:0),0); }
function tw(s){ return s.oklad+s.pct+bTotal(s.bon); }
function pp(z,r){ return Math.round(r/C.zones[z].brk[0]*100); }
function ddays(a,b){ return Math.round((new Date(b)-new Date(a))/86400000)+1; }
function fd(d){ return new Date(d).toLocaleDateString('ru-RU',{day:'numeric',month:'short'}); }
function fm(n){ return Math.abs(n)>=1e6?(n/1e6).toFixed(2)+'–ú ‚Ç∏':Math.round(n).toLocaleString('ru')+' ‚Ç∏'; }

// ‚îÄ‚îÄ‚îÄ –°–ú–ï–ù–´ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let shifts=[], sid=0, ch1=null, ch2=null;

function loadShifts(){
  try{
    const r=localStorage.getItem('gds_sh');
    if(r){
      const a=JSON.parse(r);
      shifts=a.map(s=>{const z=gz(s.st),w=cw(z,s.rv);return{...s,z,...w,plan:pp(z,s.rv),days:ddays(s.st,s.en)};});
      if(shifts.length) sid=Math.max(...shifts.map(s=>s.id));
    }
  }catch(e){shifts=[];}
}
function saveShifts(){
  try{ localStorage.setItem('gds_sh', JSON.stringify(shifts)); }catch(e){}
  syncSheets();
}

function addShift(){
  const st=document.getElementById('fS').value;
  const en=document.getElementById('fE').value;
  const sl=document.getElementById('fSl').value;
  const rv=parseFloat(document.getElementById('fRv').value);
  if(!st||!en||!rv||rv<=0){ alert('–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!'); return; }
  if(new Date(st)>new Date(en)){ alert('–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–æ–∑–∂–µ –∫–æ–Ω—Ü–∞!'); return; }
  const z=gz(st), w=cw(z,rv);
  sid++;
  shifts.push({id:sid,st,en,sl,rv,z,days:ddays(st,en),...w,plan:pp(z,rv),bon:[true,true,true,true]});
  document.getElementById('fRv').value='';
  saveShifts();
  renderCalc();
}
function delShift(id){ shifts=shifts.filter(s=>s.id!==id); saveShifts(); renderCalc(); }
function togBon(id,i,v){ const s=shifts.find(x=>x.id===id); if(s){s.bon[i]=v; saveShifts(); renderCalc();} }
function clearAll(){ if(confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–º–µ–Ω—ã?')){ shifts=[]; sid=0; saveShifts(); renderCalc(); } }

// ‚îÄ‚îÄ‚îÄ –†–ï–ù–î–ï–† –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCalc(){
  document.getElementById('shCnt').textContent=shifts.length;
  const L=document.getElementById('shList');
  if(!shifts.length){
    L.innerHTML='<div style="text-align:center;padding:32px 14px;color:var(--mt);"><div style="font-size:2rem;margin-bottom:8px;">üìã</div><div style="font-size:12px;line-height:1.6;">–î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é —Å–º–µ–Ω—É<br>—á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤—ã—à–µ</div></div>';
    document.getElementById('empR').style.display='flex';
    document.getElementById('anl').style.display='none';
    return;
  }
  document.getElementById('empR').style.display='none';
  document.getElementById('anl').style.display='block';

  L.innerHTML=shifts.map(s=>{
    const total=tw(s), bw=Math.min(s.plan,100);
    const bc=s.plan>=100?'var(--gr)':s.plan>=70?'var(--gold)':'var(--bl)';
    return '<div class="sc">'
      +'<div class="sch"><div>'
      +'<div class="scsl">üë§ '+s.sl+'</div>'
      +'<div class="scdt">'+fd(s.st)+' ‚Äî '+fd(s.en)+' ¬∑ '+s.days+' –¥–Ω.</div>'
      +'</div><button class="scdl" onclick="delShift('+s.id+')">√ó</button></div>'
      +'<div class="scmt">'
      +'<span class="tag '+ZCLS[s.z]+'">'+C.zones[s.z].nm+'</span>'
      +'<span class="tag ttg" style="color:'+TCOL[s.idx]+'">'+s.lbl+' '+(s.rate*100).toFixed(1)+'%</span>'
      +'</div>'
      +'<div class="scss">'
      +'<div class="sb rv"><div class="sbl">–í—ã—Ä—É—á–∫–∞</div><div class="sbv">'+fm(s.rv)+'</div></div>'
      +'<div class="sb sl"><div class="sbl">–ó–ü —Å –±–æ–Ω—É—Å–∞–º–∏</div><div class="sbv">'+fm(total)+'</div></div>'
      +'</div>'
      +'<div class="pbw"><div class="pbl"><span>–ü–ª–∞–Ω ('+(C.zones[s.z].brk[0]/1e6).toFixed(1)+'–ú)</span>'
      +'<span style="color:'+bc+';font-weight:700">'+s.plan+'%</span></div>'
      +'<div class="pb"><div class="pbf" style="width:'+bw+'%;background:'+bc+'"></div></div></div>'
      +'<div class="bnrw">'
      +C.bons.map((b,i)=>'<label class="bchp '+(s.bon[i]?'on':'')+'"><input type="checkbox" '+(s.bon[i]?'checked':'')+' onchange="togBon('+s.id+','+i+',this.checked)">'+b.lbl.split(' ').slice(0,2).join(' ')+' +'+Math.round(b.amt/1000)+'–ö</label>').join('')
      +'</div>'
      +'<div class="sctot"><span style="color:var(--dm);font-size:11px;">–ò—Ç–æ–≥–æ –∫ –≤—ã–ø–ª–∞—Ç–µ:</span><span style="font-weight:700;color:var(--gr);">'+fm(total)+'</span></div>'
      +'</div>';
  }).join('');

  renderAnal();
}

function renderAnal(){
  const totR=shifts.reduce((a,s)=>a+s.rv,0);
  const totF=shifts.reduce((a,s)=>a+tw(s),0);
  const fp=(totF/totR*100).toFixed(1);
  document.getElementById('kR').textContent=fm(totR);
  document.getElementById('kRS').textContent='–∑–∞ '+shifts.length+' —Å–º–µ–Ω';
  document.getElementById('kF').textContent=fm(totF);
  document.getElementById('kFP').textContent=fp+'%';
  document.getElementById('kSC').textContent=shifts.length;
  document.getElementById('kSS').textContent=[...new Set(shifts.map(s=>s.sl))].join(', ');

  const tb=document.getElementById('tBd'); tb.innerHTML='';
  shifts.forEach((s,i)=>{
    const total=tw(s), bn=bTotal(s.bon);
    const bc=s.plan>=100?'#2ecc71':s.plan>=70?'#FFD700':'#5b9cf6';
    const tr=document.createElement('tr');
    tr.innerHTML='<td>'+(i+1)+'</td><td style="color:var(--tx)">'+s.sl+'</td>'
      +'<td>'+fd(s.st)+'‚Äì'+fd(s.en)+'</td><td>'+s.days+'</td>'
      +'<td><span class="tag '+ZCLS[s.z]+'" style="font-size:9px">'+C.zones[s.z].nm+'</span></td>'
      +'<td class="amb">'+fm(s.rv)+'</td>'
      +'<td><span class="tag ttg" style="font-size:9px;color:'+TCOL[s.idx]+'">'+s.lbl+'</span></td>'
      +'<td>'+(s.rate*100).toFixed(1)+'%</td>'
      +'<td>'+fm(s.oklad)+'</td><td class="pos">'+fm(s.pct)+'</td><td class="pos">'+fm(bn)+'</td>'
      +'<td class="pos">'+fm(total)+'</td>'
      +'<td>'+(total/s.rv*100).toFixed(1)+'%</td>'
      +'<td><div style="display:flex;align-items:center;gap:5px;">'
      +'<div style="width:46px;height:4px;background:var(--bd);border-radius:2px;overflow:hidden;">'
      +'<div style="width:'+Math.min(s.plan,100)+'%;height:100%;background:'+bc+'"></div></div>'
      +'<span style="font-size:10px;color:'+bc+';font-weight:700">'+s.plan+'%</span>'
      +'</div></td>';
    tb.appendChild(tr);
  });
  const r2=document.createElement('tr'); r2.className='tot';
  const tO=shifts.reduce((a,s)=>a+s.oklad,0), tP=shifts.reduce((a,s)=>a+s.pct,0), tB=shifts.reduce((a,s)=>a+bTotal(s.bon),0);
  r2.innerHTML='<td colspan="5">–ò–¢–û–ì–û</td><td class="amb">'+fm(totR)+'</td><td></td><td></td>'
    +'<td>'+fm(tO)+'</td><td class="pos">'+fm(tP)+'</td><td class="pos">'+fm(tB)+'</td>'
    +'<td class="pos">'+fm(totF)+'</td><td>'+(totF/totR*100).toFixed(1)+'%</td><td></td>';
  tb.appendChild(r2);

  const abv=shifts.filter(s=>s.plan>=100).length;
  const avg=Math.round(shifts.reduce((a,s)=>a+s.plan,0)/shifts.length);
  const ok=parseFloat(fp)<=6;
  document.getElementById('noteEl').className='note '+(ok?'nok':'nw');
  document.getElementById('noteEl').innerHTML='<strong>–ò—Ç–æ–≥:</strong> –°—Ä–µ–¥–Ω–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ '+avg+'% ¬∑ –í—ã—à–µ –ø–ª–∞–Ω–∞: <strong>'+abv+'/'+shifts.length+'</strong> ¬∑ –§–û–¢: <strong>'+fp+'%</strong> '+(ok?'‚úÖ –Ω–æ—Ä–º–∞':'‚ö†Ô∏è >6%');

  Chart.defaults.color='#7a8196'; Chart.defaults.borderColor='#2a2f3d';
  const lbs=shifts.map((s,i)=>'#'+(i+1)+' '+s.sl.split(' ')[0]+'\n'+fd(s.st));
  if(ch1) ch1.destroy();
  ch1=new Chart(document.getElementById('c1'),{type:'bar',data:{labels:lbs,datasets:[
    {label:'–í—ã—Ä—É—á–∫–∞ (–ú)',data:shifts.map(s=>+(s.rv/1e6).toFixed(2)),backgroundColor:'rgba(255,215,0,.6)',borderRadius:4,yAxisID:'y'},
    {label:'–ó–ü (–ö)',data:shifts.map(s=>Math.round(tw(s)/1000)),type:'line',borderColor:'#2ecc71',pointBackgroundColor:'#2ecc71',pointRadius:4,fill:false,tension:.4,yAxisID:'y2'},
  ]},options:{responsive:true,plugins:{legend:{position:'top',labels:{boxWidth:10,font:{family:'Manrope',size:10}}}},
    scales:{x:{grid:{display:false},ticks:{font:{family:'Manrope',size:10},maxRotation:0}},
      y:{grid:{color:'#1e2330'},ticks:{callback:v=>v+'–ú',font:{family:'Manrope',size:10}},position:'left'},
      y2:{ticks:{callback:v=>v+'–ö',font:{family:'Manrope',size:10}},position:'right',grid:{display:false}}}}});
  if(ch2) ch2.destroy();
  ch2=new Chart(document.getElementById('c2'),{type:'bar',data:{labels:lbs,datasets:[
    {label:'–û–∫–ª–∞–¥',data:shifts.map(s=>Math.round(s.oklad/1000)),backgroundColor:'rgba(91,156,246,.7)',borderRadius:4},
    {label:'%',data:shifts.map(s=>Math.round(s.pct/1000)),backgroundColor:'rgba(255,215,0,.75)',borderRadius:4},
    {label:'–ë–æ–Ω—É—Å—ã',data:shifts.map(s=>Math.round(bTotal(s.bon)/1000)),backgroundColor:'rgba(46,204,113,.7)',borderRadius:4},
  ]},options:{responsive:true,plugins:{legend:{position:'top',labels:{boxWidth:10,font:{family:'Manrope',size:10}}}},
    scales:{x:{stacked:true,grid:{display:false},ticks:{font:{family:'Manrope',size:10},maxRotation:0}},
      y:{stacked:true,grid:{color:'#1e2330'},ticks:{callback:v=>v+'–ö',font:{family:'Manrope',size:10}}}}}});
}

// ‚îÄ‚îÄ‚îÄ –°–•–ï–ú–ê ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderScheme(){
  const ZC=['var(--bl)','var(--gold)','var(--gr)'];
  document.getElementById('schG').innerHTML=C.zones.map((z,zi)=>{
    const rows=TLBL.map((l,ti)=>{
      const from=ti===0?'–¥–æ '+(z.brk[0]/1e6).toFixed(1)+'–ú':ti<3?(z.brk[ti-1]/1e6).toFixed(1)+'‚Äì'+(z.brk[ti]/1e6).toFixed(1)+'–ú':(z.brk[2]/1e6).toFixed(1)+'–ú+';
      return '<div class="tr t'+ti+'"><div class="trl">'+l+': '+from+' ‚Ç∏</div><div class="trr">'+(z.rt[ti]*100).toFixed(1)+'%</div></div>';
    }).join('');
    return '<div class="sz sz'+zi+'"><div class="szn" style="color:'+ZC[zi]+'">'+z.nm+'</div>'
      +'<div class="szm">'+z.ms+'</div>'
      +'<div class="szo">–û–∫–ª–∞–¥: '+C.oklad.toLocaleString('ru')+' ‚Ç∏</div>'+rows+'</div>';
  }).join('');

  document.getElementById('bonR').innerHTML=C.bons.map(b=>'<div class="bp"><span>'+b.lbl+'</span><strong>+'+b.amt.toLocaleString('ru')+' ‚Ç∏</strong></div>').join('');

  const ZC2=['var(--bl)','var(--gold)','var(--gr)'];
  const exRevs=[[5500000,0],[7000000,0],[8500000,1],[9500000,1],[12000000,2],[14000000,2]];
  document.getElementById('exG').innerHTML=exRevs.map(([rv,zi])=>{
    const z=C.zones[zi], w=cw(zi,rv), mx=C.bons.reduce((a,b)=>a+b.amt,0);
    return '<div class="ex"><div class="ext" style="color:'+ZC2[zi]+'">'+z.nm+' '+(rv/1e6).toFixed(0)+'–ú ('+w.lbl+')</div>'
      +'<div class="exr"><span>–û–∫–ª–∞–¥</span><span>'+fm(w.oklad)+'</span></div>'
      +'<div class="exr"><span>'+(rv/1e6).toFixed(0)+'–ú √ó '+(w.rate*100).toFixed(1)+'%</span><span class="pos">'+fm(w.pct)+'</span></div>'
      +'<div class="exr"><span>–ë–æ–Ω—É—Å—ã (4/4)</span><span class="pos">'+fm(mx)+'</span></div>'
      +'<div class="exr"><span>–ò—Ç–æ–≥–æ</span><span class="amb">'+fm(w.oklad+w.pct+mx)+'</span></div></div>';
  }).join('');
}

// ‚îÄ‚îÄ‚îÄ –ü–†–û–ì–ù–û–ó ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let fcDone=false;
function renderForecast(){
  fcDone=false;
  const tb=document.getElementById('fcBd'); tb.innerHTML='';
  const sD=[],pD=[]; let tF=0,tR=0;
  const mx=C.bons.reduce((a,b)=>a+b.amt,0);
  REV25.forEach((r,i)=>{
    const r26=r*1.22, sh=r26/2, z=C.zbm[i], w=cw(z,sh);
    const sm=w.oklad+w.pct+mx, fot=sm*2, fp=(fot/r26*100).toFixed(1);
    tF+=fot; tR+=r26; sD.push(Math.round(sm/1000)); pD.push(parseFloat(fp));
    const tr=document.createElement('tr');
    tr.innerHTML='<td>'+MNM[i]+'</td><td><span class="tag '+ZCLS[z]+'" style="font-size:9px">'+C.zones[z].nm+'</span></td>'
      +'<td>'+fm(r)+'</td><td class="amb">'+fm(r26)+'</td><td>'+fm(sh)+'</td>'
      +'<td><span class="tag ttg" style="font-size:9px;color:'+TCOL[w.idx]+'">'+w.lbl+'</span></td>'
      +'<td class="amb">'+(w.rate*100).toFixed(1)+'%</td>'
      +'<td class="pos">'+fm(w.oklad+w.pct)+'</td><td class="pos">'+fm(sm)+'</td>'
      +'<td>'+fm(fot)+'</td><td>'+fp+'%</td>';
    tb.appendChild(tr);
  });
  const r2=document.createElement('tr'); r2.className='tot';
  r2.innerHTML='<td>–ò–¢–û–ì–û</td><td></td><td>'+fm(REV25.reduce((a,b)=>a+b,0))+'</td>'
    +'<td class="amb">'+fm(REV25.reduce((a,b)=>a+b,0)*1.22)+'</td>'
    +'<td></td><td></td><td></td><td></td><td></td>'
    +'<td class="pos">'+fm(tF)+'</td><td class="amb">'+(tF/tR*100).toFixed(2)+'%</td>';
  tb.appendChild(r2);
  Chart.defaults.color='#7a8196'; Chart.defaults.borderColor='#2a2f3d';
  const s25=REV25.map((r,i)=>{const z=C.zbm[i],w=cw(z,r/2);return Math.round((w.oklad+w.pct+mx)/1000);});
  new Chart(document.getElementById('fcC1'),{type:'bar',data:{labels:MSH,datasets:[
    {label:'2025',data:s25,backgroundColor:'rgba(74,81,104,.6)',borderRadius:3},
    {label:'2026',data:sD,backgroundColor:'rgba(255,215,0,.75)',borderRadius:3},
  ]},options:{responsive:true,plugins:{legend:{position:'top',labels:{boxWidth:10,font:{family:'Manrope',size:10}}}},
    scales:{x:{grid:{display:false},ticks:{font:{family:'Manrope',size:11}}},y:{grid:{color:'#1e2330'},ticks:{callback:v=>v+'–ö',font:{family:'Manrope',size:11}}}}}});
  new Chart(document.getElementById('fcC2'),{type:'bar',data:{labels:MSH,datasets:[
    {label:'–§–û–¢ %',data:pD,backgroundColor:pD.map(p=>p>6?'rgba(231,76,60,.65)':p>4?'rgba(255,215,0,.65)':'rgba(46,204,113,.65)'),borderRadius:3},
  ]},options:{responsive:true,plugins:{legend:{position:'top',labels:{boxWidth:10,font:{family:'Manrope',size:10}}}},
    scales:{x:{grid:{display:false},ticks:{font:{family:'Manrope',size:11}}},y:{grid:{color:'#1e2330'},ticks:{callback:v=>v+'%',font:{family:'Manrope',size:11}},max:8}}}});
}

// ‚îÄ‚îÄ‚îÄ –ù–ê–°–¢–†–û–ô–ö–ò ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderSettings(){
  document.getElementById('sOk').value=C.oklad;
  document.getElementById('sOkCur').textContent=C.oklad.toLocaleString('ru')+' ‚Ç∏';
  document.getElementById('sBR').value=(C.zones[0].rt[0]*100).toFixed(1);
  document.getElementById('sBons').innerHTML=C.bons.map((b,i)=>
    '<div style="background:var(--s2);border-radius:8px;padding:10px;">'
    +'<div style="font-size:10px;color:var(--dm);margin-bottom:5px;">'+b.lbl+'</div>'
    +'<input type="number" id="sb'+i+'" value="'+b.amt+'" step="1000" min="0">'
    +'</div>'
  ).join('');
  document.getElementById('sMons').innerHTML=MNM.map((m,i)=>
    '<div style="background:var(--s2);border-radius:8px;padding:10px;">'
    +'<div style="font-size:11px;font-weight:700;color:var(--tx);margin-bottom:6px;">'+m+'</div>'
    +'<select id="sm'+i+'">'
    +[0,1,2].map(z=>'<option value="'+z+'" '+(C.zbm[i]===z?'selected':'')+'>'+C.zones[z].nm+'</option>').join('')
    +'</select></div>'
  ).join('');
  document.getElementById('sPlans').innerHTML=C.zones.map((z,zi)=>{
    const ZC=['var(--bl)','var(--gold)','var(--gr)'];
    return '<div style="background:var(--s2);border-radius:10px;padding:14px;border:1px solid var(--bd);">'
      +'<div style="font-size:11px;font-weight:800;text-transform:uppercase;letter-spacing:1px;color:'+ZC[zi]+';margin-bottom:12px;">'+z.nm+'</div>'
      +TLBL.map((l,ti)=>
        '<div style="margin-bottom:8px;">'
        +'<div style="font-size:10px;color:var(--mt);margin-bottom:3px;">'+l+(ti<3?' ‚Äî –ø–æ—Ä–æ–≥ (–º–ª–Ω)':' ‚Äî %')+'</div>'
        +'<div style="display:grid;grid-template-columns:'+(ti<3?'1fr 1fr':'1fr')+';gap:6px;">'
        +(ti<3?'<input type="number" id="sb'+zi+'_'+ti+'" step="0.5" min="0" value="'+(z.brk[ti]/1e6).toFixed(1)+'" style="font-size:12px;padding:6px 8px;">':'')
        +'<input type="number" id="sr'+zi+'_'+ti+'" step="0.1" min="0" max="10" value="'+(z.rt[ti]*100).toFixed(1)+'" style="font-size:12px;padding:6px 8px;color:var(--gold);font-weight:700;">'
        +'</div></div>'
      ).join('')
      +'</div>';
  }).join('');
}

function saveSettings(){
  const ok=parseInt(document.getElementById('sOk').value);
  if(ok>0) C.oklad=ok;
  const br=parseFloat(document.getElementById('sBR').value)/100;
  if(!isNaN(br)&&br>0) C.zones.forEach(z=>z.rt[0]=br);
  C.bons.forEach((_,i)=>{ const el=document.getElementById('sb'+i); if(el){const v=parseInt(el.value);if(!isNaN(v)&&v>=0) C.bons[i].amt=v;} });
  MNM.forEach((_,i)=>{ const el=document.getElementById('sm'+i); if(el) C.zbm[i]=parseInt(el.value); });
  // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ –º–µ—Å—è—Ü–µ–≤
  const zm=[[],[],[]]; MNM.forEach((m,i)=>zm[C.zbm[i]].push(MSH[i]));
  C.zones.forEach((z,zi)=>z.ms=zm[zi].join('¬∑'));
  C.zones.forEach((z,zi)=>{
    [0,1,2].forEach(ti=>{
      const be=document.getElementById('sb'+zi+'_'+ti);
      const re=document.getElementById('sr'+zi+'_'+ti);
      if(be){const v=parseFloat(be.value);if(!isNaN(v)&&v>0) z.brk[ti]=Math.round(v*1e6);}
      if(re){const v=parseFloat(re.value);if(!isNaN(v)&&v>0) z.rt[ti]=v/100;}
    });
    const re3=document.getElementById('sr'+zi+'_3');
    if(re3){const v=parseFloat(re3.value);if(!isNaN(v)&&v>0) z.rt[3]=v/100;}
  });
  saveCfg();
  // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–º–µ–Ω—ã
  shifts=shifts.map(s=>{const z=gz(s.st),w=cw(z,s.rv);return{...s,z,...w,plan:pp(z,s.rv)};});
  document.getElementById('sOkCur').textContent=C.oklad.toLocaleString('ru')+' ‚Ç∏';
  renderScheme(); renderCalc();
  const btn=document.getElementById('savBtn');
  btn.textContent='‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!'; btn.style.background='var(--gr)';
  setTimeout(()=>{btn.textContent='üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å';btn.style.background='';},2000);
}

function resetSettings(){
  if(!confirm('–°–±—Ä–æ—Å–∏—Ç—å –∫ —É–º–æ–ª—á–∞–Ω–∏—é?')) return;
  C=JSON.parse(JSON.stringify(DEF));
  saveCfg();
  shifts=shifts.map(s=>{const z=gz(s.st),w=cw(z,s.rv);return{...s,z,...w,plan:pp(z,s.rv)};});
  renderScheme(); renderCalc(); renderSettings();
}

// ‚îÄ‚îÄ‚îÄ GOOGLE SHEETS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SHU='https://script.google.com/macros/s/AKfycbzwf04ilnROLs7T8cvfeMI_7CeW_SU2TLY-WK1WmOIsseR0xuklI4JH6XecvyTuAooT/exec';
function setSt(m,c){const e=document.getElementById('syncSt');if(e){e.textContent=m;e.style.color=c||'var(--dm)';}}
async function syncSheets(){
  if(!SHU){setSt('üíæ –õ–æ–∫–∞–ª—å–Ω–æ','var(--mt)');return;}
  setSt('üîÑ –°–æ—Ö—Ä...','var(--am)');
  try{
    const r=await fetch(SHU,{method:'POST',headers:{'Content-Type':'text/plain'},body:JSON.stringify({action:'save',shifts,cnt:sid})});
    const j=await r.json();
    setSt(j.ok?'‚úÖ '+new Date().toLocaleTimeString('ru'):'‚ö†Ô∏è –¢–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ',j.ok?'var(--gr)':'var(--am)');
  }catch(e){setSt('‚ö†Ô∏è –û—Ñ–ª–∞–π–Ω','var(--am)');}
}
async function loadSheets(){
  if(!SHU){loadShifts();setSt('üíæ –õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º','var(--mt)');return;}
  setSt('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...','var(--am)');
  try{
    const r=await fetch(SHU+'?action=load&t='+Date.now());
    const j=await r.json();
    if(j.ok&&j.shifts&&j.shifts.length){
      sid=j.cnt||j.shifts.length;
      shifts=j.shifts.map(s=>{const z=gz(s.st),w=cw(z,s.rv);return{...s,z,...w,plan:pp(z,s.rv),days:ddays(s.st,s.en)};});
      try{localStorage.setItem('gds_sh',JSON.stringify(shifts));}catch(e){}
      setSt('‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ Sheets','var(--gr)');
    }else{loadShifts();setSt('üìÇ –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à','var(--dm)');}
  }catch(e){loadShifts();setSt('‚ö†Ô∏è –û—Ñ–ª–∞–π–Ω','var(--am)');}
}

// ‚îÄ‚îÄ‚îÄ EXCEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function expXL(){
  if(!shifts.length){alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö!');return;}
  const rows=[['#','–ü—Ä–æ–¥–∞–≤–µ—Ü','–ù–∞—á–∞–ª–æ','–ö–æ–Ω–µ—Ü','–î–Ω–µ–π','–ó–æ–Ω–∞','–í—ã—Ä—É—á–∫–∞','–£—Ä–æ–≤–µ–Ω—å','%','–û–∫–ª–∞–¥','%—Å—É–º–º–∞','–ë–æ–Ω—É—Å—ã','–ò—Ç–æ–≥–æ','–§–û–¢%','–ü–ª–∞–Ω%']];
  shifts.forEach((s,i)=>{const t=tw(s),b=bTotal(s.bon);
    rows.push([i+1,s.sl,s.st,s.en,s.days,C.zones[s.z].nm.replace(/[^\u0400-\u04ffA-Za-z ]/g,'').trim(),s.rv,s.lbl,+(s.rate*100).toFixed(1),s.oklad,s.pct,b,t,+(t/s.rv*100).toFixed(1),s.plan]);});
  const totR=shifts.reduce((a,s)=>a+s.rv,0),totF=shifts.reduce((a,s)=>a+tw(s),0);
  rows.push(['','–ò–¢–û–ì–û','','','','',totR,'','','','','',totF,+(totF/totR*100).toFixed(1),'']);
  const ws=XLSX.utils.aoa_to_sheet(rows),wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'gradus');
  XLSX.writeFile(wb,'gradus_'+new Date().getFullYear()+'_'+String(new Date().getMonth()+1).padStart(2,'0')+'.xlsx');
}

// ‚îÄ‚îÄ‚îÄ –ù–ê–í–ò–ì–ê–¶–ò–Ø ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function ST(n,el){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('tab-'+n).classList.add('active');
  el.classList.add('active');
  if(n==='scheme')   renderScheme();
  if(n==='forecast') renderForecast();
  if(n==='settings') renderSettings();
}

// ‚îÄ‚îÄ‚îÄ –°–¢–ê–†–¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
loadCfg();
(async()=>{
  await loadSheets();
  renderCalc();
  renderScheme();
})();
</script>
</body>
</html>
